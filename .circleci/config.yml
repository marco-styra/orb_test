version: 2.1

description: orb test

orbs:
  styra-orb:
    executors:
      cli:
        docker:
          - image: styra/cli
    commands:
      cli-check:
        parameters:
          api_token:
            description: Styra API Token
            type: string
            default: undefined
        steps:
          - run: echo "Running Check" << parameters.api_token >>
          #- run: styra-cli configure -i test.styra.com -t << parameters.api_token >>
          - run: ls -al
          #- run: styra-cli get tokens
          #- run: styra-cli validate check-local -r .

commands:
  local-cli-check:
    parameters:
      api_token:
        description: Styra API Token
        type: string
        default: undefined
    steps:
      - run: echo "Running Check" << parameters.api_token >>
      
jobs:
  styra-check:
    executor: styra-orb/cli
    steps:
      - checkout # check out the code in the project directory
      - styra-orb/cli-check:
        api_token : "marco"
  local-styra-check:
    executor: styra-orb/cli
    steps:
      - checkout # check out the code in the project directory
      - local-cli-check:
        api_token : "marco"


workflows:
  check-workflow:
    jobs:
    - styra-check:
        context: test